# 3. Interpolación polinomial

Dada una tabla de $(n+1)$ puntos: $(x_0,y_0),(x_1,y_1),\dots,(x_n,y_n)$, donde $x_0,x_1,\dots,x_n$ son distintos, se desea determinar un polinomio $p$, con el **menor grado posible**, tal que

$$
p(x_i)=y_i\qquad\text{para}\quad i=0,\dots,n
$$

En este caso se dice que tal polinomio $p$ **interpola** el conjunto de puntos dados.

---

**Teorema 1 (existencia y unicidad del polinomio interpolante)**

Dados $x_0,x_1,\dots,x_n$ números reales distintos con valores asociados $y_0,y_1,\dots,y_n$ entonces existe un único polinomio $p_n$ de grado menor o igual a $n$ tal que $p_n(x_i)=y_i$, para $i=0,\dots,n$.

---

## Forma de Newton del polinomio interpolante

La forma de Newton se obtiene inductivamente, agregando un nuevo término al polinomio interpolante de un grado menor.

Si $n=0$: definimos el polinomio constante $p_0(x)=c_0=y_0$.

Si $n=1$: dados los puntos $(x_0,y_0),(x_1,y_1),$ se construye $p_1$ tal que $p_1(x)=c_0+c_1(x-x_0)$ y $p_1(x_0)=c_0=y_0$. Usando que $p_1(x_1)=y_1$, entonces $y_1=c_0+c_1(x_1-x_0)$ y por lo tanto, $$c_1=\frac{y_1-c_0}{x_1-x_0}$$

Si $n=k$: tenemos que

$$
p_k(x)=p_{k-1}(x)+c_k(x-x_0)(x-x_1)...(x-x_{k-1})
$$

y por recurrencia obtenemos que

$$
p_k(x)=c_0+c_1(x-x_0)+c_2(x-x_0)(x-x_1)+\dots+c_k(x-x_0)...(x-x_{k-1})
$$

La forma de Newton compacta del polinomio interpolante resulta en

$$
p_k(x)=\sum_{i=0}^kc_i\prod_{j=0}^{i-1}(x-x_j)
$$

Aquí se adopta la convención que $\prod_{j=0}^m(x-x_j)=1$ si $m<0$.

---

Para evaluar $p_k(x)$, una vez calculados los coeficientes $c_k$, es conveniente usar el algoritmo de Horner de muliplicación encajada.

---

## Diferencias divididas

Notemos que el coeficiente $c_0$ se obtiene simplemente de $c_0=y_0$ $($ o de $f(x_0)). El coeficiente $c_1$ se calcula con $y_1$ $($ o de $f(x_1))$, despejando en

$$
y_1=p_1(x_1)=c_0+c_1(x_1-x_0),\quad\text{esto es}\quad c_1=\frac{y_1-y_0}{x_1-x_0}
$$

este coeficiente depende de $x_0,x_1,y_0,y_1$. En general, para calcular el coeficiente $c_k$ se requieren conocer $x_0,\dots,x_k,y_0,\dots,y_k$, o si estamos interpolando a una función $f$ se requieren $x_0,\dots,x_k,f(x_0),\dots,f(x_k)$. Este coefieciente se denota por

$$
c_k=f[x_0,x_1,\dots,x_k]
$$

para $k=0,\dots,n$ y se denomina **diferencias divididas**.

La forma de Newton compacta  del polonimio interpolante resulta en

$$
p_k(x)=\sum_{i=0}^kf[x_0,x_1,\dots,x_i]\prod_{j=0}^{i-1}(x-x_j)
$$

donde si $k=0$:

$$
f[x_0]=f(x_0)
$$

si $k=1$:

$$f[x_0,x_1]=\frac{f(x_1)-f(x_0)}{x_1-x_0}$$

---

**Terorema**

Dados $x_0,x_1,\dots,x_n$ números reales distintos. Las diferencias divididas satisfacen la siguiente ecuación

$$
f[x_0,x_1,\dots,x_n]=\frac{f[x_1,x_2,\dots,x_n]-f[x_0,x_1,\dots,x_{n-1}]}{x_n-x_0}
$$

---

### Propiedades de las diferencias divididas

El primero es un resultado sobre la permutación de los puntos de interpolación, el segundo sobre el error de interpolación y el tercero relaciona las diferencias divididas con las derivadas de orden superior.

---

**Teorema**

Sean $x_0,x_1,\dots,x_n$ números reales distintos y $z_0,z_1,\dots,z_n$ un reordenamiento de $x_0,x_1,\dots,x_n$. Entonces $f[z_0,z_1,\dots,z_n]=f[x_0,x_1,\dots,x_n]$.

---

**Teorema**

Sea $p$ el plinomio de grado $\leq n$ que interpola a $f$ en los $n+1$ nodos distintos $x_0,x_1,\dots,x_n$. Si $t$ es un número real distinto de los nodos, entonces

$$
f(t)-p(t)=f[x_0,x_1,\dots,x_n,t]\prod_{j=0}^n(t-x_j)
$$

---

**Teorema**

Si $f$ es una función $n$ veces continuamente diferenciable en $[a,b]$ y $x_0,x_1,\dots,x_n$ son $n+1$ nodos distints en $[a,b]$, entonces existe un punto $\xi\in(a,b)$ tal que

$$
f[x_0,x_1,\dots,x_n]=\frac{1}{n!}f^{(n)}(\xi)
$$

---

## Forma de Lagrange del polinomio interpolante

Primero se definen los **polinomios básicos de Lagrange** asociado a los puntos distintos $x_0,x_1,\dots,x_n$:

$$
l_i(x)=\prod_{j=0,\,j\neq i}\frac{(x-x_j)}{(x_i-x_j)}\quad\text{para}\quad i=0,\dots,n
$$

es claro que el grado de $l_i(x)$ es igual $n$ para $i=0,\dots,n$ y que

$$
l_i(x_j)=\delta_{ij}=\begin{cases}1&\text{si }i=j\\0&\text{si }i\neq j\end{cases}
$$

Ahora definimos la **forma de Lagrange** del polinomio interpolante por

$$
p_n(x)=\sum_{i=0}^ny_il_i(x)
$$

Es claro que $p_n$ es un polinomio de grado $\leq n$ y que $p_n(x_i)=y_i$, para $i=0,\dots,n$.

## Error del polinomio interpolante

**Teorema**

Sea $f$ una función en $C^{n+1}[a,b]$ y $p$ un polinomio de grado $\leq n$ que interpola a $f$ en $(n+1)$ puntos distintos $x_0,x_1,\dots,x_n$ en $[a,b]$. Entonces para cada $x\in[a,b]$ existe un $\xi=\xi_x\in(a,b)$ tal que

$$
f(x)-p(x)=\frac{1}{(n+1)!}f^{(n+1)}(\xi)\prod_{i=0}^n(x-x_i)
$$

---

### Convergencia uniforme de los polinomios de interpolación

El teorema anterior da una expresión, para cada punto $x$, del error que se comete al interpolar una función $f$ por un polinomio interpolante $p$.


Ahora bien, si se construyen polinomios interpolantes $p_n$ utilizando cada vez más puntos, o equivalentemente de grado cada vez más alto, sería natural esperar que estos polinomios convergieran uniformemente a la función $f$ en el intervalo $[a,b]$. Es decir, esperaríamos

$$
\|f-p_n\|_{\infty}=\max |f(x)-p_n(x)|\to0\quad\text{si}\quad n\to\infty
$$

Lamentablemente, para la mayoría de las funciones continuas no ocurre esto debido al comportamiento intestable de los polinomio de grado alto.

---

## Splines

Supongamos que se desea interpolar una función $f$ por un polinomio interpolante $p_n$. Usar pocos puntos de interpolación podía generar un polinomio que no aproxime bien a la función.

Por otro lado, como se comentó anteriormente, y contrariamente a lo que podría esperarse, aumentar la cantidad de puntos de interpolación no mejora la convergencia uniforme del polinomio interpolante $p_n$ a la función $f$.

Una ida que trata de conciliar estos conceptos opuestos es aplicar interpolación con polinomios de grado bajo por subintervalos. Esto es conocido como **interpolación polinomial por partes** o **interpolación segmentaria** o simplemente **splines**.

---

**Definición**

Una función **spline** está formada por polinomios definidos en subintervalos, los cuales se unen entre sí obedeciendo ciertas condiciones de continuidad.

Más formalmente, dados $n+1$ puntos tales que $x_0<x_1<\dots<x_n$, que denominaremos **nodos**, y un entero $k\leq0$, un **spline de grado $k$** es una función $S$ definida en $[x_0,x_n]$ que satisface:

* $S$ es un polinomio de grado $\leq k$ en cada subintervalo $[x_i,x_{i+1})$, para $i=0,\dots,n-1$:

* las derivadas $S^{(i)}$ son continuas en $[x_0,x_n],$ para $i=0,\dots,k-1$.

---

### Splines lineales

Dados los $n+1$ nodos tales que $x_0<x_1<\dots<x_n$, un **spline lineal** $(k=1)$ es una función $S$ definida en $[x_0,x_n]$ que satisface:

* $S$ es un polinomio de grado $\leq 1$ (recta) en cada subintervalo $[x_i,x_{i+1})$, para $i=0,\dots,n-1$;

* la función $S$ es continua en $[x_0,x_n]$.

Es decir

$$
S(x)=\begin{cases}
S_0(x)=a_0x+b_0, &x\in[x_0,x_1)\\
S_1(x)=a_1x+b_1,&x\in[x_1,x_2)\\
\qquad\vdots\\
S_{n-1}(x)=a_{n-1}x+b_{n-1}, & x\in[x_{n-1},x_n]
\end{cases}
$$

donde los $2n$ coeficientes $a_i,b_i$ para $i=0,\dots,n-1$ son las incógnitas a ser determinadas. Para eso, se deben tener $2n$ condiciones.

---

**Observación**

Supongamos que $f$ es $2$ vces continuamente diferenciable en $[a,b]$ y $x_k=a+kh,\,$ $k=0,\dots,n$ con $h=(b-a)/n$.

Si $S$ es un spline lineal, en cada intervalo $[x_k,x_{k+1}]$ se tiene un polinomio de grado $\leq1$. Entonces el error de interpolación para cada $x\in[a,b]$ está dada por:

$$
|e(x)|\leq\frac{M}{8}\,h^2
$$

---

### Spline cúbicos

Dados los $n+1$ nodos tales que $x_0<x_1<\dots<x_n$, un **spline cúbico** $(k=3)$ es una función $S$ definida en $[x_0,x_n]$ que satisface:

* $S$ es un polinomio de grado $\leq 3$ en cada subintervalo $[x_i,x_{i+1})$, para $i=0,\dots,n-1$;

* las funciones $S, S'$ y $S''$ son continuas en $[x_0,x_n]$.

Es decir,

$$
S(x)=\begin{cases}
S_0(x)=a_0x^3+b_0x^2+c_0x+d_0, &x\in[x_0,x_1)\\
S_1(x)=a_1x^3+b_1x^2+c_1x+d_1,&x\in[x_1,x_2)\\
\qquad\vdots\\
S_{n-1}(x)=a_{n-1}x^3+b_{n-1}x^2+c_{n-1}x+d_{n-1} &x\in[x_{n-1},x_n]
\end{cases}
$$

donde los $4_n$ coeficientes $a_i,b_i,c_i,d_i$, para $i=0,\dots,n-1$ son las incógnitas a ser determinadas. Para eso, se deben tener $4n$ condiciones.

$(n+1)$ condiciones de interpolación:

$$\tag{$i=0,\dots,n$}
S(x_i)=f(x_i),
$$

$(n-1)$ condiciones de continuidad de $S$:

$$\tag{$i=0,\dots,n-2$}
S_i(x_{i+1})=\lim_{x\to x_{i+1}}S_i(x)=S_{i+1}(x_{i+1})\qquad
$$

$(n-1)$ condiciones de continuidad de $S'$:

$$\tag{$i=0,\dots,n-2$}
S_i'(x_{i+1})=\lim_{x\to x_{i+1}}S_i'(x)=S_{i+1}'(x_{i+1})\qquad
$$

$(n-1)$ condiciones de continuidad de $S''$:

$$\tag{$i=0,\dots,n-2$}
S_i''(x_{i+1})=\lim_{x\to x_{i+1}}S_i''(x)=S_{i+1}''(x_{i+1})\qquad
$$

Para poder determinar una única solución se deben imponer dos condiciones adicionales:

$$
S''(x_0)=S''_0(x_0)=0\quad\text{y}\quad S''(x_n)=S''_{n-1}(x_n)=0
$$

En este caso, se denomina **spline con condiciones naturales** o simplemente **spline natural**.

Otra veces se suele utilizar

$$
S'(x_0)=S_0'(x_0)=f'(x_0)\quad\text{y}\quad S'(x_n)=S'_{n-1}(x_n)=f'(x_n)
$$

En este caso, se denomina **spline con condiciones correctas**.

---